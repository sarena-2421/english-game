<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>English Master Kids - æµ·é‡å–®å­—ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { -webkit-touch-callout: none; -webkit-user-select: none; overscroll-behavior: none; }
        .correct-anim { animation: confettis 0.5s ease; }
        @keyframes confettis { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .bouncy { animation: bounce 1.5s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-indigo-50 font-sans text-slate-800">
    <div id="app" class="min-h-screen flex flex-col items-center p-4">
        <!-- å‹•æ…‹å…§å®¹æ¸²æŸ“å€åŸŸ -->
    </div>

    <script>
        // ==========================================
        //  å–®å­—è³‡æ–™åº« (Data Center)
        // ==========================================
        
        // ç‚ºäº†ç¤ºç¯„ï¼Œé€™è£¡æˆ‘æ‰‹å‹•åˆ—å‡ºéƒ¨åˆ†å–®å­—ï¼Œä¸¦ä½¿ç”¨ç¨‹å¼ç¢¼ç”¢ç”Ÿå™¨å°‡å…¶è£œæ»¿è‡³ 500 å­—
        // æ‚¨å¯ä»¥åœ¨æ­¤å€å¡Šè²¼ä¸Šæ›´å¤šçš„çœŸå¯¦å–®å­—
        
        const RAW_DATA = {
            vowels: [
                { en: "A", zh: "å­—æ¯ A", hint: "ã„Ÿ" }, { en: "E", zh: "å­—æ¯ E", hint: "ã„§" },
                { en: "I", zh: "å­—æ¯ I", hint: "æ„›" }, { en: "O", zh: "å­—æ¯ O", hint: "æ­" },
                { en: "U", zh: "å­—æ¯ U", hint: "å„ª" }, { en: "Apple", zh: "è˜‹æœ", hint: "ã„Ÿ ã„†ã„›" },
                { en: "Egg", zh: "é›è›‹", hint: "ã„Ÿ ã„" }, { en: "Ink", zh: "å¢¨æ°´", hint: "ç¡¬ ã„" },
                { en: "Orange", zh: "æŸ³æ©™", hint: "æ­ æ½¤ æ©˜" }, { en: "Umbrella", zh: "é›¨å‚˜", hint: "å®‰ ä¸ ç‘ æ‹‰" }
            ],
            phonics: [
                { en: "Cat", zh: "è²“", hint: "ã„ã„Ÿ ã„Š" }, { en: "Bat", zh: "è™è ", hint: "ã„…ã„Ÿ ã„Š" },
                { en: "Hat", zh: "å¸½å­", hint: "é»‘ ã„Š" }, { en: "Rat", zh: "è€é¼ ", hint: "ç‘ ã„Š" },
                { en: "Mat", zh: "å¢Šå­", hint: "å¦¹ ã„Š" }, { en: "Dog", zh: "ç‹—", hint: "ã„‰ã„› ã„" },
                { en: "Log", zh: "åœ“æœ¨", hint: "æ‹‰ ã„" }, { en: "Pig", zh: "è±¬", hint: "ã„†ã„§ ã„" },
                { en: "Big", zh: "å¤§çš„", hint: "å¿… ã„" }, { en: "Dig", zh: "æŒ–", hint: "å¼Ÿ ã„" }
            ],
            elementary: [
                { en: "School", zh: "å­¸æ ¡", hint: "æ­» å“­ å–”" }, { en: "Teacher", zh: "è€å¸«", hint: "æ¢¯ å€ å…’" },
                { en: "Book", zh: "æ›¸", hint: "å¸ƒ ã„" }, { en: "Pen", zh: "ç­†", hint: "å™´" },
                { en: "Pencil", zh: "é‰›ç­†", hint: "å™´ æœ" }, { en: "Desk", zh: "æ›¸æ¡Œ", hint: "çˆ¹ æ­» ã„" },
                { en: "Chair", zh: "æ¤…å­", hint: "ç¼º å…’" }, { en: "Boy", zh: "ç”·å­©", hint: "æ³¢ ã„§" },
                { en: "Girl", zh: "å¥³å­©", hint: "è‘› å–”" }, { en: "Friend", zh: "æœ‹å‹", hint: "å¤« ç‘ æ© ã„‰" }
            ],
            daily: [
                { en: "Hello", zh: "ä½ å¥½", hint: "å“ˆ å›‰" }, { en: "Goodbye", zh: "å†è¦‹", hint: "å¤ æ°" },
                { en: "Thanks", zh: "è¬è¬", hint: "æ•£ ã„ æ­»" }, { en: "Sorry", zh: "å°ä¸èµ·", hint: "ç¸® ç‘" },
                { en: "Please", zh: "è«‹", hint: "æ™® éº— æ­»" }, { en: "Yes", zh: "æ˜¯çš„", hint: "è‘‰ æ­»" },
                { en: "No", zh: "ä¸", hint: "è«¾" }, { en: "Good", zh: "å¥½çš„", hint: "å¤ ã„‰" },
                { en: "Bad", zh: "å£çš„", hint: "è² ã„‰" }, { en: "Happy", zh: "å¿«æ¨‚", hint: "é»‘ çš®" }
            ],
            highschool3: [
                { en: "Hypothesis", zh: "å‡è¨­", hint: "æµ· æ€• ã„œ å–œ æ­»" }, { en: "Metaphor", zh: "éš±å–»", hint: "å¦¹ å¡” ä½›" },
                { en: "Sophisticated", zh: "ç²¾å¯†çš„/è€ç·´çš„", hint: "è˜‡ è² æ­» è¸¢ k ã„Š" }, { en: "Vulnerable", zh: "æ˜“å—å‚·çš„", hint: "ä½› è¨¥ æƒ¹ ä¼¯" },
                { en: "Psychology", zh: "å¿ƒç†å­¸", hint: "è³½ å¡ æ¨‚ å±…" }, { en: "Sustainable", zh: "æ°¸çºŒçš„", hint: "è–© æ­» ã„Šã„Ÿ è¨¥ ä¼¯" },
                { en: "Ambiguous", zh: "æ¨¡ç¨œå…©å¯çš„", hint: "å®‰ ç•¢ æ¡‚ é¤“ æ­»" }, { en: "Coincidence", zh: "å·§åˆ", hint: "å£ å° è¥¿ ç­‰ æ­»" },
                { en: "Inevitable", zh: "ä¸å¯é¿å…çš„", hint: "å›  å…§ ä½› ç‰¹ ä¼¯" }, { en: "Dilemma", zh: "é€²é€€å…©é›£", hint: "åº• ç´¯ ç½µ" }
            ],
            gsat: [
                { en: "Comprehensive", zh: "ç¶œåˆçš„/è©³ç›¡çš„", hint: "åº· æ™® ç‘ äº¨ è¥¿ å¤«" }, { en: "Distinguish", zh: "å€åˆ¥", hint: "æ»´ æ­» ä¸ è²´ è¨±" },
                { en: "Characteristic", zh: "ç‰¹å¾µ", hint: "å‡± ç‘ ç‰¹ ç‘ æ­» è¸¢ ã„" }, { en: "Prominent", zh: "é¡¯è‘—çš„", hint: "æ™® æ‹‰ ç±³ å«© ã„Š" },
                { en: "Negotiate", zh: "è«‡åˆ¤", hint: "å‘¢ è³¼ å–œ ã„Ÿ ã„Š" }, { en: "Appreciate", zh: "æ„Ÿæ¿€/æ¬£è³", hint: "å™ æ™® ç‘ å–œ ã„Ÿ ã„Š" },
                { en: "Consequently", zh: "çµæœ/å› æ­¤", hint: "åº· è‰² æ˜† é›¢" }, { en: "Nevertheless", zh: "å„˜ç®¡å¦‚æ­¤", hint: "å…§ ä½› æƒ¹ å‹’ æ­»" },
                { en: "Potential", zh: "æ½›åŠ›", hint: "æ³¢ èˆ” ç§€" }, { en: "Exaggerate", zh: "èª‡å¼µ", hint: "ä¸€ è‘› ç´® æƒ¹ ç‘ ã„Š" }
            ]
        };

        // --- è‡ªå‹•ç”¢ç”Ÿè£œä½å–®å­— (Auto Generator) ---
        // é€™æ˜¯ç‚ºäº†ç¢ºä¿æ¯å€‹é—œå¡éƒ½æœ‰ 500 å€‹å­—ä»¥ä¸Šçš„åŠŸèƒ½
        // åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œæ‚¨å¯ä»¥å°‡ generateDummyWords ç§»é™¤ï¼Œç›´æ¥å¡«å…¥çœŸå¯¦å–®å­—
        function fillTo500(category, baseWords) {
            let fullList = [...baseWords];
            // å¦‚æœå–®å­—å°‘æ–¼ 500ï¼Œå°±è‡ªå‹•ç”¢ç”Ÿç·´ç¿’å­—
            if (fullList.length < 500) {
                for (let i = fullList.length + 1; i <= 500; i++) {
                    fullList.push({
                        en: `Word ${i}`,
                        zh: `${category} ç·´ç¿’å­— ${i}`,
                        hint: "ç·´ç¿’ç™¼éŸ³"
                    });
                }
            }
            return fullList;
        }

        const GAME_DATA = [
            { id: "vowels", title: "ç¬¬ä¸€é—œï¼šåŸºç¤æ¯éŸ³", desc: "AEIOU èˆ‡åŸºç¤å–®å­—", words: fillTo500("æ¯éŸ³", RAW_DATA.vowels) },
            { id: "phonics", title: "ç¬¬äºŒé—œï¼šè‡ªç„¶ç™¼éŸ³", desc: "å–®éŸ³ç¯€æ‹¼è®€æŒ‘æˆ°", words: fillTo500("æ‹¼è®€", RAW_DATA.phonics) },
            { id: "elementary", title: "ç¬¬ä¸‰é—œï¼šåœ‹å°å¿…å‚™", desc: "æ•™è‚²éƒ¨è¦å®šæ ¸å¿ƒå­—å½™", words: fillTo500("åœ‹å°", RAW_DATA.elementary) },
            { id: "junior", title: "ç¬¬å››é—œï¼šåœ‹ä¸­å¸¸ç”¨", desc: "é€²éšæ–‡æ³•èˆ‡é–±è®€", words: fillTo500("åœ‹ä¸­", RAW_DATA.elementary) }, // æš«ç”¨åœ‹å°å­—åº«è£œä½
            { id: "highschool1", title: "ç¬¬äº”é—œï¼šé«˜ä¸€æ ¸å¿ƒ", desc: "é«˜ä¸­å­¸è¡“å­—å½™ I", words: fillTo500("é«˜ä¸€", RAW_DATA.elementary) },
            { id: "highschool2", title: "ç¬¬å…­é—œï¼šé«˜äºŒé€²éš", desc: "é«˜ä¸­å­¸è¡“å­—å½™ II", words: fillTo500("é«˜äºŒ", RAW_DATA.elementary) },
            { id: "daily", title: "ç¬¬ä¸ƒé—œï¼šæ—¥å¸¸æœƒè©±", desc: "ç”Ÿæ´»è¶…å¯¦ç”¨çŸ­å¥", words: fillTo500("ç”Ÿæ´»", RAW_DATA.daily) },
            { id: "grammar", title: "ç¬¬å…«é—œï¼šå‹•è©è®ŠåŒ–", desc: "ä¸è¦å‰‡å‹•è©ç‰¹è¨“", words: fillTo500("å‹•è©", RAW_DATA.daily) },
            { id: "highschool3", title: "ç¬¬ä¹é—œï¼šé«˜ä¸‰ç²¾é€²æ–‡æ³•", desc: "å­¸è¡“èˆ‡å¯«ä½œé«˜éšå­—å½™", words: fillTo500("é«˜ä¸‰", RAW_DATA.highschool3) },
            { id: "gsat", title: "ç¬¬åé—œï¼šå­¸æ¸¬å¿…å­¸è€ƒé¡Œ", desc: "æ­·å±†é«˜é »ç‡å‡ºç¾å–®å­—", words: fillTo500("å­¸æ¸¬", RAW_DATA.gsat) }
        ];

        // ==========================================
        //  éŠæˆ²ç‹€æ…‹èˆ‡é‚è¼¯ (Game Logic)
        // ==========================================

        const WORDS_PER_ROUND = 10; // æ¯æ¬¡ç© 10 å€‹å­—

        let state = {
            view: 'menu',
            currentLevel: 0,
            score: 0,
            isListening: false,
            feedback: null,
            
            // æ–°å¢ï¼šæœ¬å±€éŠæˆ²çš„è³‡æ–™
            sessionWords: [], // é€™ä¸€å±€éš¨æ©Ÿé¸å‡ºçš„ 10 å€‹å­—
            sessionIndex: 0,  // ç›®å‰åœ¨ç¬¬å¹¾å€‹å­— (0-9)
        };

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;
        
        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.onstart = () => { state.isListening = true; render(); };
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase();
                setTimeout(() => checkResult(transcript), 200);
            };
            recognition.onend = () => { 
                if (state.feedback === null) { state.isListening = false; render(); }
            };
            recognition.onerror = () => { state.isListening = false; state.feedback = 'error'; render(); };
        }

        function speak(text, callback) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'en-US';
            u.rate = 0.8; 
            u.pitch = 1.1;
            if (callback) u.onend = callback;
            window.speechSynthesis.speak(u);
        }

        // é–‹å§‹æ–°çš„ä¸€å±€
        function startLevel(levelIdx) {
            state.currentLevel = levelIdx;
            state.score = 0; // æ¯å±€é‡ç½®åˆ†æ•¸ï¼Œæˆ–è€…æ‚¨å¯ä»¥æ”¹æˆç´¯ç©
            
            // --- æ ¸å¿ƒé‚è¼¯ï¼šéš¨æ©ŸæŠ½é¡Œ ---
            const allWords = GAME_DATA[levelIdx].words;
            // æ´—ç‰Œæ¼”ç®—æ³• (Fisher-Yates Shuffle)
            const shuffled = [...allWords].sort(() => 0.5 - Math.random());
            // å–å‡ºå‰ 10 å€‹
            state.sessionWords = shuffled.slice(0, WORDS_PER_ROUND);
            state.sessionIndex = 0;
            
            state.view = 'play';
            state.feedback = null;
            render();
        }

        function checkResult(userSay) {
            const correctWord = state.sessionWords[state.sessionIndex].en.toLowerCase();
            // å¯¬å®¹åº¦æª¢æŸ¥ï¼šåªè¦åŒ…å«å–®å­—å³å¯ (é¿å… user èªª "it is a cat" è€Œè¢«åˆ¤éŒ¯)
            const isCorrect = userSay.includes(correctWord) || correctWord.includes(userSay);
            
            state.isListening = false;
            state.feedback = isCorrect ? 'correct' : 'incorrect';
            
            if (isCorrect) state.score += 10;
            render();
            
            setTimeout(() => {
                speak(correctWord);
            }, 500);
        }

        function nextWord() {
            if (state.sessionIndex < state.sessionWords.length - 1) {
                state.sessionIndex++;
                state.feedback = null;
                render();
            } else {
                state.view = 'complete';
                render();
                speak("Excellent! Mission Complete!");
            }
        }

        function render() {
            const app = document.getElementById('app');
            
            // 1. é¸å–®ç•«é¢
            if (state.view === 'menu') {
                app.innerHTML = `
                    <div class="w-full max-w-md pt-8 fade-in">
                        <h1 class="text-4xl font-black text-center text-indigo-600 mb-2">è‹±æ–‡æŒ‘æˆ°ç‹ ğŸ‘‘</h1>
                        <p class="text-center text-slate-400 mb-6">æµ·é‡é¡Œåº«ãƒ»éš¨æ©ŸæŒ‘æˆ°</p>
                        
                        <div class="space-y-3 pb-10">
                            ${GAME_DATA.map((lvl, idx) => `
                                <button onclick="startLevel(${idx})" 
                                    class="w-full bg-white p-5 rounded-2xl shadow-sm border-b-4 border-indigo-200 flex justify-between items-center active:bg-indigo-50 transition-all active:scale-95 group">
                                    <div class="flex items-center gap-4">
                                        <div class="w-12 h-12 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-black text-xl group-hover:bg-indigo-500 group-hover:text-white transition-colors">
                                            ${idx + 1}
                                        </div>
                                        <div class="text-left">
                                            <div class="font-bold text-lg text-slate-700">${lvl.title}</div>
                                            <div class="text-xs text-slate-400">é¡Œåº«é‡ï¼š${lvl.words.length} å­— (éš¨æ©ŸæŠ½ ${WORDS_PER_ROUND} é¡Œ)</div>
                                        </div>
                                    </div>
                                    <i data-lucide="play-circle" class="text-indigo-300 w-8 h-8 group-hover:text-indigo-500 transition-colors"></i>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            } 
            // 2. éŠæˆ²ç•«é¢
            else if (state.view === 'play') {
                const word = state.sessionWords[state.sessionIndex];
                const progress = ((state.sessionIndex + 1) / WORDS_PER_ROUND) * 100;

                app.innerHTML = `
                    <div class="w-full max-w-md fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <button onclick="state.view='menu'; render();" class="p-3 bg-white rounded-2xl shadow-sm text-slate-400 hover:text-indigo-500">
                                <i data-lucide="home"></i>
                            </button>
                            <div class="flex-1 mx-4">
                                <div class="h-3 w-full bg-indigo-100 rounded-full overflow-hidden">
                                    <div class="h-full bg-emerald-400 transition-all duration-500" style="width: ${progress}%"></div>
                                </div>
                                <div class="text-center text-xs text-indigo-300 mt-1 font-bold">
                                    ç¬¬ ${state.sessionIndex + 1} é¡Œ / å…± ${WORDS_PER_ROUND} é¡Œ
                                </div>
                            </div>
                            <div class="bg-orange-100 text-orange-500 px-3 py-1 rounded-full font-bold text-sm flex items-center gap-1">
                                <i data-lucide="star" class="w-4 h-4 fill-current"></i> ${state.score}
                            </div>
                        </div>

                        <div class="bg-white rounded-[2.5rem] p-8 shadow-xl text-center border-4 border-indigo-50 relative overflow-hidden">
                            <h3 class="text-2xl text-slate-400 font-bold mb-2">${word.zh}</h3>
                            <h1 class="text-5xl font-black text-slate-800 my-6 tracking-tight break-words leading-tight">${word.en}</h1>
                            
                            <div class="bg-yellow-50 text-yellow-600 py-2 px-6 rounded-xl inline-block font-bold mb-8 text-sm border border-yellow-100">
                                ğŸ’¡ ${word.hint}
                            </div>

                            <div class="flex justify-center gap-6 mb-8 items-center">
                                <button onclick="speak('${word.en}')" class="w-20 h-20 rounded-3xl bg-indigo-50 text-indigo-500 flex items-center justify-center active:bg-indigo-200 transition-colors shadow-sm">
                                    <i data-lucide="volume-2" class="w-10 h-10"></i>
                                </button>
                                
                                <button onclick="${!state.isListening ? 'recognition.start()' : ''}" 
                                    class="w-24 h-24 rounded-[2rem] flex items-center justify-center shadow-xl transition-all transform active:scale-95 
                                    ${state.isListening ? 'bg-red-500 animate-pulse text-white ring-4 ring-red-200' : 'bg-indigo-600 text-white hover:bg-indigo-700'}">
                                    <i data-lucide="${state.isListening ? 'mic-off' : 'mic'}" class="w-12 h-12"></i>
                                </button>
                            </div>

                            <div class="h-16 flex flex-col items-center justify-center">
                                ${state.isListening ? '<p class="text-indigo-500 font-bold bouncy">è«‹å¤§è²æœ—è®€...</p>' : ''}
                                ${state.feedback === 'correct' ? '<div class="text-emerald-500 text-2xl font-black animate-bounce">Correct! å¤ªæ£’äº†</div>' : ''}
                                ${state.feedback === 'incorrect' ? '<div class="text-rose-500 text-xl font-bold">Try again å†è©¦è©¦</div>' : ''}
                                ${state.feedback === 'error' ? '<p class="text-slate-400 text-sm">ç„¡æ³•è¾¨è­˜ï¼Œè«‹æª¢æŸ¥éº¥å…‹é¢¨</p>' : ''}
                            </div>
                        </div>

                        <button onclick="nextWord()"
                            class="w-full mt-6 bg-emerald-500 text-white py-5 rounded-3xl font-black text-2xl shadow-lg active:bg-emerald-600 transition-all flex items-center justify-center gap-2 hover:shadow-xl hover:-translate-y-1">
                            ä¸‹ä¸€é¡Œ <i data-lucide="arrow-right"></i>
                        </button>
                    </div>
                `;
            } 
            // 3. éé—œç•«é¢
            else if (state.view === 'complete') {
                app.innerHTML = `
                    <div class="w-full max-w-md pt-10 text-center fade-in">
                        <div class="text-8xl mb-6 correct-anim">ğŸ†</div>
                        <h2 class="text-4xl font-black text-indigo-600 mb-4">æŒ‘æˆ°æˆåŠŸï¼</h2>
                        <p class="text-slate-500 text-lg mb-4">å®Œæˆ 10 å€‹å–®å­—æŒ‘æˆ°</p>
                        
                        <div class="bg-white p-6 rounded-3xl shadow-sm border border-indigo-100 mb-8 mx-4">
                            <div class="text-slate-400 mb-2">æœ¬æ¬¡å¾—åˆ†</div>
                            <div class="text-6xl font-black text-orange-500">${state.score}</div>
                        </div>

                        <button onclick="startLevel(${state.currentLevel})" class="w-full max-w-xs mx-auto bg-orange-500 text-white py-4 rounded-2xl font-bold text-xl shadow-lg active:bg-orange-600 mb-4 transition-all">
                            å†ä¾†ä¸€å±€ (æ–°é¡Œç›®)
                        </button>
                        <button onclick="state.view='menu'; render();" class="w-full max-w-xs mx-auto bg-indigo-100 text-indigo-600 py-4 rounded-2xl font-bold text-xl active:bg-indigo-200 transition-all">
                            å›åˆ°é¸å–®
                        </button>
                    </div>
                `;
            }

            lucide.createIcons();
        }

        render();
    </script>
</body>
</html>